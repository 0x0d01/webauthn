var B=Object.defineProperty;var O=(e,a)=>{for(var r in a)B(e,r,{get:a[r],enumerable:!0})};function F(e){return Uint8Array.from(e,a=>a.charCodeAt(0)).buffer}function f(e){return String.fromCharCode(...new Uint8Array(e))}function b(e){return e.match(/^[a-zA-Z0-9\-_]+=*$/)!==null}function c(e){return btoa(f(e)).replaceAll("+","-").replaceAll("/","_")}function o(e){return e=e.replaceAll("-","+").replaceAll("_","/"),F(atob(e))}async function y(e){return await window.crypto.subtle.digest("SHA-256",e)}function p(e){return[...new Uint8Array(e)].map(a=>a.toString(16).padStart(2,"0")).join("")}function g(e,a){var r=new Uint8Array(e.byteLength+a.byteLength);return r.set(new Uint8Array(e),0),r.set(new Uint8Array(a),e.byteLength),r}var m={};O(m,{"08987058-cadc-4b81-b6e1-30de50dcbe96":()=>E,"12ded745-4bed-47d4-abaa-e713f51d6393":()=>te,"149a2021-8ef6-4133-96b8-81f8d5b7f1f5":()=>U,"1c086528-58d5-f211-823c-356786e36140":()=>Be,"2c0df832-92de-4be1-8412-88a8f074df4a":()=>R,"2fc0579f-8113-47ea-b116-bb5a8db9202a":()=>q,"34f5766d-1536-4a24-9033-0e294e510fb0":()=>re,"3789da91-f943-46bc-95c3-50ea2012f03a":()=>I,"39a5647e-1853-446c-a1f6-a79bae9f5bc7":()=>D,"3b1adb99-0dfe-46fd-90b8-7f7614a4de2a":()=>Y,"3e078ffd-4c54-4586-8baa-a77da113aec5":()=>he,"3e22415d-7fdf-4ea4-8a0c-dd60c4249b9d":()=>Z,"4e768f2c-5fab-48b3-b300-220eb487752b":()=>x,"504d7149-4e4c-3841-4555-55445a677357":()=>ye,"516d3969-5a57-5651-5958-4e7a49434167":()=>z,"54d9fee8-e621-4291-8b18-7157b99c5bec":()=>oe,"6028b017-b1d4-4c02-b4b3-afcdafc96bb2":()=>se,"692db549-7ae5-44d5-a1e5-dd20a493b723":()=>Q,"6d44ba9b-f6ec-2e49-b930-0c8fe920cb73":()=>ue,"73402251-f2a8-4f03-873e-3cb6db604b03":()=>fe,"73bb0cd4-e502-49b8-9c6f-b59445bf720b":()=>V,"77010bd7-212a-4fc9-b236-d2ca5e9d4084":()=>Oe,"820d89ed-d65a-409e-85cb-f73f0578f82a":()=>J,"833b721a-ff5f-4d00-bb2e-bdda3ec01e29":()=>Fe,"83c47309-aabb-4108-8470-8be838b573cb":()=>ne,"85203421-48f9-4355-9bc8-8a53846e5083":()=>M,"88bbd2f0-342a-42e7-9729-dd158be5407a":()=>ae,"8c97a730-3f7b-41a6-87d6-1e9b62bda6f0":()=>pe,"931327dd-c89b-406c-a81e-ed7058ef36c6":()=>T,"9c835346-796b-4c27-8898-d6032f515cc5":()=>C,"9ddd1817-af5a-4672-a2b9-3e3dd95000a9":()=>G,"9f0d8150-baa5-4c00-9299-ad62c8bb4e87":()=>ee,"9f77e279-a6e2-4d58-b700-31e5943c6a98":()=>de,"a1f52be5-dfab-4364-b51c-2bd496b14a56":()=>ge,"aeb6569c-f8fb-4950-ac60-24ca2bbe2e52":()=>X,"b6ede29c-3772-412c-8a78-539c1f4c62d2":()=>W,"b92c3f9a-c014-4056-887f-140a2501163b":()=>ce,"b93fd961-f2e6-462f-b122-82002247de78":()=>j,"bc2fe499-0d8e-4ffe-96f3-94a82840cf8c":()=>Se,"be727034-574a-f799-5c76-0929e0430973":()=>ie,"c1f9a0bc-1dd2-404a-b27f-8e29047a43fd":()=>be,"c5703116-972b-4851-a3e7-ae1259843399":()=>k,"c5ef55ff-ad9a-4b9f-b580-adebafe026d0":()=>K,"cb69481e-8ff7-4039-93ec-0a2729a154a8":()=>me,"d41f5a69-b817-4144-a13c-9ebd6d9254d6":()=>we,"d821a7d4-e97c-4cb6-bd82-4237731fd4be":()=>_,"d8522d9f-575b-4866-88a9-ba99fa02f35b":()=>$,"d91c5288-0ef0-49b7-b8ae-21ca0aa6b3f3":()=>H,default:()=>Ce,"e1a96183-5016-4f24-b55b-e3ae23614cc6":()=>N,"e416201b-afeb-41ca-a03d-2281c28322aa":()=>le,"ee041bce-25e5-4cdb-8f86-897fd6418464":()=>v,"ee882879-721c-4913-9775-3dfcce97072a":()=>Ae,"f8a011f3-8c0a-4d15-8006-17111f9edc7d":()=>L,"fa2b99dc-9e39-4257-8f92-4a30d23c4118":()=>P});var C={name:"Cryptnox FIDO2"},K={name:"YubiKey 5Ci"},D={name:"Vancosys Android Authenticator"},I={name:"NEOWAVE Winkeo FIDO2"},P={name:"YubiKey 5 Series with NFC"},x={name:"Hideez Key 4 FIDO2 SDK"},T={name:"Swissbit iShield FIDO2"},N={name:"ATKey.Pro CTAP2.0"},E={name:"Windows Hello Hardware Authenticator"},H={name:"KEY-ID FIDO2 Authenticator"},v={name:"Feitian ePass FIDO2-NFC Authenticator"},V={name:"YubiKey 5 FIPS Series"},U={name:"Security Key by Yubico with NFC"},Y={name:"GoTrust Idem Key FIDO2 Authenticator"},L={name:"Security Key by Yubico"},R={name:"Feitian FIDO Smart Card"},k={name:"NEOWAVE Badgeo FIDO2"},J={name:"Vancosys iOS Authenticator"},W={name:"Feitian BioPass FIDO2 Plus Authenticator"},M={name:"YubiKey 5Ci FIPS"},_={name:"Hyper FIDO Bio Security Key"},z={name:"SmartDisplayer BobeePass (NFC-BLE FIDO2 Authenticator)"},j={name:"Android Authenticator with SafetyNet Attestation"},q={name:"YubiKey 5 Series with NFC"},G={name:"Windows Hello VBS Hardware Authenticator"},$={name:"YubiKey Bio Series"},Q={name:"HID Crescendo Key"},Z={name:"Feitian iePass FIDO Authenticator"},X={name:"HID Crescendo C2300"},ee={name:"GoTrust Idem Card FIDO2 Authenticator"},te={name:"Feitian AllinOne FIDO2 Authenticator"},ae={name:"Precision InnaIT Key FIDO 2 Level 2 certified"},re={name:"YubiKey 5 Series CTAP2.1 Preview 1 "},ne={name:"YubiKey Bio Series (Enterprise Profile)"},ie={name:"Crayonic KeyVault K1 (USB-NFC-BLE FIDO2 Authenticator)"},ce={name:"Security Key by Yubico"},oe={name:"HID Crescendo Enabled"},se={name:"Windows Hello Software Authenticator"},ue={name:"Security Key by Yubico with NFC"},le={name:"ATKey.Pro CTAP2.1"},de={name:"Hyper FIDO Pro"},fe={name:"uTrust FIDO2 Security Key"},be={name:"YubiKey 5 FIPS Series with NFC"},ye={name:"WiSECURE AuthTron USB FIDO2 Authenticator"},me={name:"YubiKey  5 Series"},Ae={name:"YubiKey 5 Series"},pe={name:"FT-JCOS FIDO Fingerprint Card"},ge={name:"OCTATCO EzFinger2 FIDO2 AUTHENTICATOR"},he={name:"Hideez Key 3 FIDO2"},we={name:"ATKey.Card CTAP2.0"},Se={name:"OCTATCO EzQuant FIDO2 AUTHENTICATOR"},Be={name:"Atos CardOS FIDO2"},Oe={name:"Feitian BioPass FIDO2 Authenticator"},Fe={name:"Feitian ePass FIDO2 Authenticator"},Ce={"9c835346-796b-4c27-8898-d6032f515cc5":C,"c5ef55ff-ad9a-4b9f-b580-adebafe026d0":K,"39a5647e-1853-446c-a1f6-a79bae9f5bc7":D,"3789da91-f943-46bc-95c3-50ea2012f03a":I,"fa2b99dc-9e39-4257-8f92-4a30d23c4118":P,"4e768f2c-5fab-48b3-b300-220eb487752b":x,"931327dd-c89b-406c-a81e-ed7058ef36c6":T,"e1a96183-5016-4f24-b55b-e3ae23614cc6":N,"08987058-cadc-4b81-b6e1-30de50dcbe96":E,"d91c5288-0ef0-49b7-b8ae-21ca0aa6b3f3":H,"ee041bce-25e5-4cdb-8f86-897fd6418464":v,"73bb0cd4-e502-49b8-9c6f-b59445bf720b":V,"149a2021-8ef6-4133-96b8-81f8d5b7f1f5":U,"3b1adb99-0dfe-46fd-90b8-7f7614a4de2a":Y,"f8a011f3-8c0a-4d15-8006-17111f9edc7d":L,"2c0df832-92de-4be1-8412-88a8f074df4a":R,"c5703116-972b-4851-a3e7-ae1259843399":k,"820d89ed-d65a-409e-85cb-f73f0578f82a":J,"b6ede29c-3772-412c-8a78-539c1f4c62d2":W,"85203421-48f9-4355-9bc8-8a53846e5083":M,"d821a7d4-e97c-4cb6-bd82-4237731fd4be":_,"516d3969-5a57-5651-5958-4e7a49434167":z,"b93fd961-f2e6-462f-b122-82002247de78":j,"2fc0579f-8113-47ea-b116-bb5a8db9202a":q,"9ddd1817-af5a-4672-a2b9-3e3dd95000a9":G,"d8522d9f-575b-4866-88a9-ba99fa02f35b":$,"692db549-7ae5-44d5-a1e5-dd20a493b723":Q,"3e22415d-7fdf-4ea4-8a0c-dd60c4249b9d":Z,"aeb6569c-f8fb-4950-ac60-24ca2bbe2e52":X,"9f0d8150-baa5-4c00-9299-ad62c8bb4e87":ee,"12ded745-4bed-47d4-abaa-e713f51d6393":te,"88bbd2f0-342a-42e7-9729-dd158be5407a":ae,"34f5766d-1536-4a24-9033-0e294e510fb0":re,"83c47309-aabb-4108-8470-8be838b573cb":ne,"be727034-574a-f799-5c76-0929e0430973":ie,"b92c3f9a-c014-4056-887f-140a2501163b":ce,"54d9fee8-e621-4291-8b18-7157b99c5bec":oe,"6028b017-b1d4-4c02-b4b3-afcdafc96bb2":se,"6d44ba9b-f6ec-2e49-b930-0c8fe920cb73":ue,"e416201b-afeb-41ca-a03d-2281c28322aa":le,"9f77e279-a6e2-4d58-b700-31e5943c6a98":de,"73402251-f2a8-4f03-873e-3cb6db604b03":fe,"c1f9a0bc-1dd2-404a-b27f-8e29047a43fd":be,"504d7149-4e4c-3841-4555-55445a677357":ye,"cb69481e-8ff7-4039-93ec-0a2729a154a8":me,"ee882879-721c-4913-9775-3dfcce97072a":Ae,"8c97a730-3f7b-41a6-87d6-1e9b62bda6f0":pe,"a1f52be5-dfab-4364-b51c-2bd496b14a56":ge,"3e078ffd-4c54-4586-8baa-a77da113aec5":he,"d41f5a69-b817-4144-a13c-9ebd6d9254d6":we,"bc2fe499-0d8e-4ffe-96f3-94a82840cf8c":Se,"1c086528-58d5-f211-823c-356786e36140":Be,"77010bd7-212a-4fc9-b236-d2ca5e9d4084":Oe,"833b721a-ff5f-4d00-bb2e-bdda3ec01e29":Fe};function A(e){console.debug(e);let a=new DataView(e.slice(32,33)).getUint8(0);console.debug(a);let r={rpIdHash:c(e.slice(0,32)),flags:{userPresent:!!(a&1),userVerified:!!(a&4),backupEligibility:!!(a&8),backupState:!!(a&16),attestedData:!!(a&64),extensionsIncluded:!!(a&128)},counter:new DataView(e.slice(33,37)).getUint32(0,!1)};if(e.byteLength>37){let s=new DataView(e.slice(53,55)).getUint16(0,!1);r={...r,aaguid:d(e),credentialId:c(e.slice(55,55+s)),publicKey:c(e.slice(55+s,e.byteLength))}}return r}function d(e){return Ke(e.slice(37,53))}function Ke(e){let a=p(e);return a=a.substring(0,8)+"-"+a.substring(8,12)+"-"+a.substring(12,16)+"-"+a.substring(16,20)+"-"+a.substring(20,24),a}function w(e){let a=d(e);return(De??m)[a]?.name}var De=null;function He(){return!!window.PublicKeyCredential}async function S(){return await PublicKeyCredential.isUserVerifyingPlatformAuthenticatorAvailable()}function ve(e){return A(o(e))}async function Pe(e){if(e==="local")return"platform";if(e==="extern")return"cross-platform";if(e!=="both")try{return await S()?"platform":"cross-platform"}catch{return}}function xe(e){switch(e){case-7:return"ES256";case-257:return"RS256";default:throw new Error(`Unknown algorithm code: ${e}`)}}async function Ve(e,a,r){if(r||(r={}),!b(a))throw new Error("Provided challenge is not properly encoded in Base64url");let s={challenge:o(a),rp:{id:window.location.hostname,name:window.location.hostname},user:{id:await y(new TextEncoder().encode(e)),name:e,displayName:e},pubKeyCredParams:[{alg:-7,type:"public-key"},{alg:-257,type:"public-key"}],timeout:r.timeout??6e4,authenticatorSelection:{userVerification:r.userVerification??"required",authenticatorAttachment:await Pe(r.authenticatorType??"auto")},attestation:"direct"};console.debug(s);let i=await navigator.credentials.create({publicKey:s});console.debug(i);let n=i.response;return{username:e,challenge:a,credential:{id:i.id,publicKey:c(n.getPublicKey()),algorithm:xe(i.response.getPublicKeyAlgorithm())},authenticator:{isLocal:i.authenticatorAttachment==="platform",aaguid:d(n.getAuthenticatorData()),name:w(n.getAuthenticatorData()),attestation:r.attestation?c(n.attestationObject):null,clientData:r.attestation?c(n.clientDataJSON):null}}}async function Te(e){if(e==="local")return["internal"];if(e==="extern")return["usb","ble","nfc"];if(e==="both")return["internal","usb","ble","nfc"];try{return await S()?["internal"]:["usb","ble","nfc"]}catch{return["internal","usb","ble","nfc"]}}async function Ue(e,a,r){if(r||(r={}),!b(a))throw new Error("Provided challenge is not properly encoded in Base64url");let s=await Te(r.authenticatorType??"auto"),i={challenge:o(a),rpId:window.location.hostname,allowCredentials:e.map(l=>({id:o(l),type:"public-key",transports:s})),userVerification:r.userVerification??"required",timeout:r.timeout??6e4};console.debug(i);let n=await navigator.credentials.get({publicKey:i});console.debug(n);let u=n.response;return{credentialId:n.id,clientJson:JSON.parse(f(u.clientDataJSON)),clientData:c(u.clientDataJSON),signature:c(u.signature),authenticatorJson:A(u.authenticatorData),authenticatorData:c(u.authenticatorData)}}async function Ye({algorithm:e,publicKey:a,authenticatorData:r,clientData:s,signature:i}){let n=await window.crypto.subtle.importKey("spki",o(a),{name:"RSASSA-PKCS1-v1_5",hash:"SHA-256"},!1,["verify"]);console.debug(n);let u=await y(o(s));console.debug(u);let l=g(o(r),u);return console.debug(l),console.debug(o(i)),await window.crypto.subtle.verify({name:"RSASSA-PKCS1-v1_5",hash:"SHA-256"},n,o(i),l)}export{He as isAvailable,S as isLocalAuthenticator,Ue as login,ve as parseAuthenticatorData,Ve as register,Ye as verify};
//# sourceMappingURL=webauthn.min.js.map
