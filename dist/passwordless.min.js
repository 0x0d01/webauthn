var w=Object.defineProperty;var B=(a,t)=>{for(var r in t)w(a,r,{get:t[r],enumerable:!0})};function O(a){return Uint8Array.from(a,t=>t.charCodeAt(0)).buffer}function l(a){return String.fromCharCode(...new Uint8Array(a))}function c(a){return btoa(l(a))}function s(a){return O(atob(a))}function d(a){return s(a.replace(/-/g,"+").replace(/_/g,"/"))}async function y(a){return await window.crypto.subtle.digest("SHA-256",a)}function g(a){return[...new Uint8Array(a)].map(t=>t.toString(16).padStart(2,"0")).join("")}function p(a,t){var r=new Uint8Array(a.byteLength+t.byteLength);return r.set(new Uint8Array(a),0),r.set(new Uint8Array(t),a.byteLength),r}var f={};B(f,{"08987058-cadc-4b81-b6e1-30de50dcbe96":()=>N,"12ded745-4bed-47d4-abaa-e713f51d6393":()=>ee,"149a2021-8ef6-4133-96b8-81f8d5b7f1f5":()=>V,"1c086528-58d5-f211-823c-356786e36140":()=>we,"2c0df832-92de-4be1-8412-88a8f074df4a":()=>L,"2fc0579f-8113-47ea-b116-bb5a8db9202a":()=>_,"34f5766d-1536-4a24-9033-0e294e510fb0":()=>te,"3789da91-f943-46bc-95c3-50ea2012f03a":()=>D,"39a5647e-1853-446c-a1f6-a79bae9f5bc7":()=>K,"3b1adb99-0dfe-46fd-90b8-7f7614a4de2a":()=>U,"3e078ffd-4c54-4586-8baa-a77da113aec5":()=>pe,"3e22415d-7fdf-4ea4-8a0c-dd60c4249b9d":()=>$,"4e768f2c-5fab-48b3-b300-220eb487752b":()=>P,"504d7149-4e4c-3841-4555-55445a677357":()=>le,"516d3969-5a57-5651-5958-4e7a49434167":()=>j,"54d9fee8-e621-4291-8b18-7157b99c5bec":()=>ce,"6028b017-b1d4-4c02-b4b3-afcdafc96bb2":()=>oe,"692db549-7ae5-44d5-a1e5-dd20a493b723":()=>Q,"6d44ba9b-f6ec-2e49-b930-0c8fe920cb73":()=>se,"73402251-f2a8-4f03-873e-3cb6db604b03":()=>fe,"73bb0cd4-e502-49b8-9c6f-b59445bf720b":()=>v,"77010bd7-212a-4fc9-b236-d2ca5e9d4084":()=>Be,"820d89ed-d65a-409e-85cb-f73f0578f82a":()=>k,"833b721a-ff5f-4d00-bb2e-bdda3ec01e29":()=>Oe,"83c47309-aabb-4108-8470-8be838b573cb":()=>re,"85203421-48f9-4355-9bc8-8a53846e5083":()=>W,"88bbd2f0-342a-42e7-9729-dd158be5407a":()=>ae,"8c97a730-3f7b-41a6-87d6-1e9b62bda6f0":()=>Ae,"931327dd-c89b-406c-a81e-ed7058ef36c6":()=>x,"9c835346-796b-4c27-8898-d6032f515cc5":()=>F,"9ddd1817-af5a-4672-a2b9-3e3dd95000a9":()=>q,"9f0d8150-baa5-4c00-9299-ad62c8bb4e87":()=>Z,"9f77e279-a6e2-4d58-b700-31e5943c6a98":()=>de,"a1f52be5-dfab-4364-b51c-2bd496b14a56":()=>ge,"aeb6569c-f8fb-4950-ac60-24ca2bbe2e52":()=>X,"b6ede29c-3772-412c-8a78-539c1f4c62d2":()=>J,"b92c3f9a-c014-4056-887f-140a2501163b":()=>ie,"b93fd961-f2e6-462f-b122-82002247de78":()=>z,"bc2fe499-0d8e-4ffe-96f3-94a82840cf8c":()=>Se,"be727034-574a-f799-5c76-0929e0430973":()=>ne,"c1f9a0bc-1dd2-404a-b27f-8e29047a43fd":()=>be,"c5703116-972b-4851-a3e7-ae1259843399":()=>R,"c5ef55ff-ad9a-4b9f-b580-adebafe026d0":()=>C,"cb69481e-8ff7-4039-93ec-0a2729a154a8":()=>ye,"d41f5a69-b817-4144-a13c-9ebd6d9254d6":()=>he,"d821a7d4-e97c-4cb6-bd82-4237731fd4be":()=>M,"d8522d9f-575b-4866-88a9-ba99fa02f35b":()=>G,"d91c5288-0ef0-49b7-b8ae-21ca0aa6b3f3":()=>E,default:()=>Fe,"e1a96183-5016-4f24-b55b-e3ae23614cc6":()=>T,"e416201b-afeb-41ca-a03d-2281c28322aa":()=>ue,"ee041bce-25e5-4cdb-8f86-897fd6418464":()=>H,"ee882879-721c-4913-9775-3dfcce97072a":()=>me,"f8a011f3-8c0a-4d15-8006-17111f9edc7d":()=>Y,"fa2b99dc-9e39-4257-8f92-4a30d23c4118":()=>I});var F={name:"Cryptnox FIDO2"},C={name:"YubiKey 5Ci"},K={name:"Vancosys Android Authenticator"},D={name:"NEOWAVE Winkeo FIDO2"},I={name:"YubiKey 5 Series with NFC"},P={name:"Hideez Key 4 FIDO2 SDK"},x={name:"Swissbit iShield FIDO2"},T={name:"ATKey.Pro CTAP2.0"},N={name:"Windows Hello Hardware Authenticator"},E={name:"KEY-ID FIDO2 Authenticator"},H={name:"Feitian ePass FIDO2-NFC Authenticator"},v={name:"YubiKey 5 FIPS Series"},V={name:"Security Key by Yubico with NFC"},U={name:"GoTrust Idem Key FIDO2 Authenticator"},Y={name:"Security Key by Yubico"},L={name:"Feitian FIDO Smart Card"},R={name:"NEOWAVE Badgeo FIDO2"},k={name:"Vancosys iOS Authenticator"},J={name:"Feitian BioPass FIDO2 Plus Authenticator"},W={name:"YubiKey 5Ci FIPS"},M={name:"Hyper FIDO Bio Security Key"},j={name:"SmartDisplayer BobeePass (NFC-BLE FIDO2 Authenticator)"},z={name:"Android Authenticator with SafetyNet Attestation"},_={name:"YubiKey 5 Series with NFC"},q={name:"Windows Hello VBS Hardware Authenticator"},G={name:"YubiKey Bio Series"},Q={name:"HID Crescendo Key"},$={name:"Feitian iePass FIDO Authenticator"},X={name:"HID Crescendo C2300"},Z={name:"GoTrust Idem Card FIDO2 Authenticator"},ee={name:"Feitian AllinOne FIDO2 Authenticator"},ae={name:"Precision InnaIT Key FIDO 2 Level 2 certified"},te={name:"YubiKey 5 Series CTAP2.1 Preview 1 "},re={name:"YubiKey Bio Series (Enterprise Profile)"},ne={name:"Crayonic KeyVault K1 (USB-NFC-BLE FIDO2 Authenticator)"},ie={name:"Security Key by Yubico"},ce={name:"HID Crescendo Enabled"},oe={name:"Windows Hello Software Authenticator"},se={name:"Security Key by Yubico with NFC"},ue={name:"ATKey.Pro CTAP2.1"},de={name:"Hyper FIDO Pro"},fe={name:"uTrust FIDO2 Security Key"},be={name:"YubiKey 5 FIPS Series with NFC"},le={name:"WiSECURE AuthTron USB FIDO2 Authenticator"},ye={name:"YubiKey  5 Series"},me={name:"YubiKey 5 Series"},Ae={name:"FT-JCOS FIDO Fingerprint Card"},ge={name:"OCTATCO EzFinger2 FIDO2 AUTHENTICATOR"},pe={name:"Hideez Key 3 FIDO2"},he={name:"ATKey.Card CTAP2.0"},Se={name:"OCTATCO EzQuant FIDO2 AUTHENTICATOR"},we={name:"Atos CardOS FIDO2"},Be={name:"Feitian BioPass FIDO2 Authenticator"},Oe={name:"Feitian ePass FIDO2 Authenticator"},Fe={"9c835346-796b-4c27-8898-d6032f515cc5":F,"c5ef55ff-ad9a-4b9f-b580-adebafe026d0":C,"39a5647e-1853-446c-a1f6-a79bae9f5bc7":K,"3789da91-f943-46bc-95c3-50ea2012f03a":D,"fa2b99dc-9e39-4257-8f92-4a30d23c4118":I,"4e768f2c-5fab-48b3-b300-220eb487752b":P,"931327dd-c89b-406c-a81e-ed7058ef36c6":x,"e1a96183-5016-4f24-b55b-e3ae23614cc6":T,"08987058-cadc-4b81-b6e1-30de50dcbe96":N,"d91c5288-0ef0-49b7-b8ae-21ca0aa6b3f3":E,"ee041bce-25e5-4cdb-8f86-897fd6418464":H,"73bb0cd4-e502-49b8-9c6f-b59445bf720b":v,"149a2021-8ef6-4133-96b8-81f8d5b7f1f5":V,"3b1adb99-0dfe-46fd-90b8-7f7614a4de2a":U,"f8a011f3-8c0a-4d15-8006-17111f9edc7d":Y,"2c0df832-92de-4be1-8412-88a8f074df4a":L,"c5703116-972b-4851-a3e7-ae1259843399":R,"820d89ed-d65a-409e-85cb-f73f0578f82a":k,"b6ede29c-3772-412c-8a78-539c1f4c62d2":J,"85203421-48f9-4355-9bc8-8a53846e5083":W,"d821a7d4-e97c-4cb6-bd82-4237731fd4be":M,"516d3969-5a57-5651-5958-4e7a49434167":j,"b93fd961-f2e6-462f-b122-82002247de78":z,"2fc0579f-8113-47ea-b116-bb5a8db9202a":_,"9ddd1817-af5a-4672-a2b9-3e3dd95000a9":q,"d8522d9f-575b-4866-88a9-ba99fa02f35b":G,"692db549-7ae5-44d5-a1e5-dd20a493b723":Q,"3e22415d-7fdf-4ea4-8a0c-dd60c4249b9d":$,"aeb6569c-f8fb-4950-ac60-24ca2bbe2e52":X,"9f0d8150-baa5-4c00-9299-ad62c8bb4e87":Z,"12ded745-4bed-47d4-abaa-e713f51d6393":ee,"88bbd2f0-342a-42e7-9729-dd158be5407a":ae,"34f5766d-1536-4a24-9033-0e294e510fb0":te,"83c47309-aabb-4108-8470-8be838b573cb":re,"be727034-574a-f799-5c76-0929e0430973":ne,"b92c3f9a-c014-4056-887f-140a2501163b":ie,"54d9fee8-e621-4291-8b18-7157b99c5bec":ce,"6028b017-b1d4-4c02-b4b3-afcdafc96bb2":oe,"6d44ba9b-f6ec-2e49-b930-0c8fe920cb73":se,"e416201b-afeb-41ca-a03d-2281c28322aa":ue,"9f77e279-a6e2-4d58-b700-31e5943c6a98":de,"73402251-f2a8-4f03-873e-3cb6db604b03":fe,"c1f9a0bc-1dd2-404a-b27f-8e29047a43fd":be,"504d7149-4e4c-3841-4555-55445a677357":le,"cb69481e-8ff7-4039-93ec-0a2729a154a8":ye,"ee882879-721c-4913-9775-3dfcce97072a":me,"8c97a730-3f7b-41a6-87d6-1e9b62bda6f0":Ae,"a1f52be5-dfab-4364-b51c-2bd496b14a56":ge,"3e078ffd-4c54-4586-8baa-a77da113aec5":pe,"d41f5a69-b817-4144-a13c-9ebd6d9254d6":he,"bc2fe499-0d8e-4ffe-96f3-94a82840cf8c":Se,"1c086528-58d5-f211-823c-356786e36140":we,"77010bd7-212a-4fc9-b236-d2ca5e9d4084":Be,"833b721a-ff5f-4d00-bb2e-bdda3ec01e29":Oe};console.debug(f);function m(a){console.debug(a);let t=new DataView(a.slice(32,33)).getUint8(0);console.debug(t);let r={rpIdHash:c(a.slice(0,32)),flags:{userPresent:!!(t&1),userVerified:!!(t&4),backupEligibility:!!(t&8),backupState:!!(t&16),attestedData:!!(t&64),extensionsIncluded:!!(t&128)},counter:new DataView(a.slice(33,37)).getUint32(0,!1)};if(a.byteLength>37){let o=new DataView(a.slice(53,55)).getUint16(0,!1);r={...r,aaguid:b(a),credentialId:c(a.slice(55,55+o)),publicKey:c(a.slice(55+o,a.byteLength))}}return r}function b(a){return Ce(a.slice(37,53))}function Ce(a){let t=g(a);return t=t.substring(0,8)+"-"+t.substring(8,12)+"-"+t.substring(12,16)+"-"+t.substring(16,20)+"-"+t.substring(20,24),t}function S(a){let t=b(a);return(Ke??f)[t]?.name}var Ke=null;function Ee(){return!!window.PublicKeyCredential}async function Ie(){return await PublicKeyCredential.isUserVerifyingPlatformAuthenticatorAvailable()}function He(a){return m(s(a))}async function Pe(a){if(a==="local")return"platform";if(a==="extern")return"cross-platform";if(a!=="both")try{return await Ie()?"platform":"cross-platform"}catch{return}}function xe(a){switch(a){case-7:return"ES256";case-257:return"RS256";default:throw new Error(`Unknown algorithm code: ${a}`)}}async function ve(a,t,r){r||(r={});let o={challenge:d(t),rp:{id:window.location.hostname,name:window.location.hostname},user:{id:await y(new TextEncoder().encode(a)),name:a,displayName:a},pubKeyCredParams:[{alg:-7,type:"public-key"},{alg:-257,type:"public-key"}],timeout:r.timeout??6e4,authenticatorSelection:{userVerification:r.userVerification??"required",authenticatorAttachment:await Pe(r.authenticatorType??"auto")},attestation:"direct"};console.debug(o);let i=await navigator.credentials.create({publicKey:o});console.debug(i);let n=i.response;return{username:a,challenge:t,credential:{id:i.id,publicKey:c(n.getPublicKey()),algorithm:xe(i.response.getPublicKeyAlgorithm())},authenticator:{isLocal:i.authenticatorAttachment==="platform",aaguid:b(n.getAuthenticatorData()),name:S(n.getAuthenticatorData()),attestation:r.attestation?c(n.attestationObject):null,clientData:r.attestation?c(n.clientDataJSON):null}}}async function Ve(a,t,r){r||(r={});let o={challenge:d(t),rpId:window.location.hostname,allowCredentials:a.map(u=>({id:d(u),type:"public-key"})),userVerification:r.userVerification??"required",timeout:r.timeout??6e4};console.debug(o);let i=await navigator.credentials.get({publicKey:o});console.debug(i);let n=i.response;return{credentialId:i.id,clientJson:JSON.parse(l(n.clientDataJSON)),clientData:c(n.clientDataJSON),signature:c(n.signature),authenticatorJson:m(n.authenticatorData),authenticatorData:c(n.authenticatorData)}}async function Ue({algorithm:a,publicKey:t,authenticatorData:r,clientData:o,signature:i}){let n=await window.crypto.subtle.importKey("spki",s(t),{name:"RSASSA-PKCS1-v1_5",hash:"SHA-256"},!1,["verify"]);console.debug(n);let u=await y(s(o));console.debug(u);let A=p(s(r),u);return console.debug(A),console.debug(s(i)),await window.crypto.subtle.verify({name:"RSASSA-PKCS1-v1_5",hash:"SHA-256"},n,s(i),A)}export{Ee as isAvailable,Ie as isLocalAuthenticator,Ve as login,He as parseAuthenticatorData,ve as register,Ue as verify};
//# sourceMappingURL=passwordless.min.js.map
